<div class="row">
  <div class="col-md-2">
    <nav role="secondary">
      <data-mycellar-admin-nav></data-mycellar-admin-nav>
    </nav>
  </div>
  <div class="col-md-10">
    <header class="page-header"><h1>Booking</h1></header>
    <form name="form" class="form">
      <error-form form="form"></error-form>
      <fieldset>
        <legend>Details</legend>
        <div class="form-group" ng-class="{'has-error': form.bookingEvent.$invalid}">
          <label class="control-label" for="bookingEvent">Booking event</label>
          <input 
              id="bookingEvent" 
              name="bookingEvent" 
              type="text" 
              class="form-control"
              ng-model="booking.bookingEvent" 
              placeholder="Booking event" 
              typeahead="bookingEvent as (bookingEvent.name + ' (' + bookingEvent.start + ' to ' + bookingEvent.end + ')') for bookingEvent in bookingEvents($viewValue)"
              typeahead-editable="false"  
              typeahead-min-length="2" 
              typeahead-wait-ms="200" />
          <error-ctrl ctrl="form.bookingEvent"></error-ctrl>
        </div>
        <div class="form-group" ng-class="{'has-error': form.customer.$invalid}">
          <label class="control-label" for="customer">Customer</label>
          <input 
              id="customer" 
              name="customer" 
              type="text"
              class="form-control" 
              ng-model="booking.customer" 
              placeholder="Customer" 
              typeahead="customer as (customer.lastname + ' ' + customer.firstname + ' (' + customer.email + ')') for customer in customers($viewValue)"
              typeahead-editable="false"  
              typeahead-min-length="2" 
              typeahead-wait-ms="200" />
          <error-ctrl ctrl="form.customer"></error-ctrl>
        </div>
      </fieldset>
      <fieldset>
        <legend>Booking</legend>
        <table class="table table-bordered table-striped table-condensed">
          <thead>
            <tr>
              <th>Wine</th>
              <th>Format</th>
              <th>Price</th>
              <th>Quantity</th>
              <th>Total</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="bookingBottle in booking.bookingEvent.bottles">
              <td>{{bookingBottle.bottle.wine | wineRenderer}}</td>
              <td>{{bookingBottle.bottle.format | formatRenderer}}</td>
              <td>{{bookingBottle.price | currency:"€"}}</td>
              <td><input class="form-control input-mini" id="quantity-{{bookingBottle.id}}" name="quantity-{{bookingBottle.id}}" type="number" ng-model="booking.quantities[booking.bookingEvent.id + '-' + bookingBottle.id]" /></td>
              <td>{{bookingBottle.price * booking.quantities[booking.bookingEvent.id + '-' + bookingBottle.id] | currency:"€"}}</td>
            </tr>
          </tbody>
          <tfoot>
            <tr>
              <th colspan="3"></th>
              <th>Total</th>
              <th>{{total | currency:"€"}}</th>
            </tr>
          </tfoot>
        </table>
      </fieldset>
      <input type="submit" class="btn btn-primary" value="Save" ng-click="save()" />
      <input type="submit" class="btn btn-default" value="Cancel" ng-click="cancel()" />
    </form>
  </div>
</div>